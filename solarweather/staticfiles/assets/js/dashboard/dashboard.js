// @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
"use strict";import{setup}from"./controls.js";class WeatherChartConfig{constructor(){this.config={type:"line",data:{labels:[],datasets:[{backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{color:"#FFFFFF"},ticks:{color:"#FFFFFF"}},y:{grid:{color:"#FFFFFF"},ticks:{color:"#FFFFFF"}}}}}}}let Chart;const weatherCharts={indoorTemp:{id:"indoor-temp-chart",chartObj:null},outdoorTemp:{id:"outdoor-temp-chart",chartObj:null}},updateGraphs=(e,t)=>{weatherCharts[e].chartObj.data.labels=t.labels,weatherCharts[e].chartObj.data.datasets[0].data=t.values,weatherCharts[e].chartObj.update()},updateDashboard=e=>{const t=document.getElementById("dashboard-indoor-temp-card"),o=t.querySelector(".loading-spinner"),a=t.querySelector(".overlay"),r=t.querySelectorAll(".blur"),n=document.getElementById("indoor-temp-now"),d=document.getElementById("indoor-temp-now-feels-like"),s=document.getElementById("indoor-temp-day-min"),l=document.getElementById("indoor-temp-day-max"),i=document.getElementById("outdoor-temp-now"),m=document.getElementById("outdoor-temp-now-feels-like"),p=document.getElementById("outdoor-temp-day-min"),c=document.getElementById("outdoor-temp-day-max"),u=e.indoor_temp.latest?e.indoor_temp.latest:0,h=e.indoor_feels_temp.latest?e.indoor_temp.latest:0,F=e.outdoor_temp.latest?e.outdoor_temp.latest:0,y=e.outdoor_feels_temp.latest?e.outdoor_feels_temp.latest:0;n.innerHTML=Number.parseFloat(u).toFixed(1),d.innerHTML=Number.parseFloat(h).toFixed(1),s.innerHTML=Number.parseFloat(e.indoor_temp.daily_min).toFixed(1),l.innerHTML=Number.parseFloat(e.indoor_temp.daily_max).toFixed(1),i.innerHTML=Number.parseFloat(F).toFixed(1),m.innerHTML=Number.parseFloat(y).toFixed(1),p.innerHTML=Number.parseFloat(e.outdoor_temp.daily_min).toFixed(1),c.innerHTML=Number.parseFloat(e.outdoor_temp.daily_max).toFixed(1);const b={labels:["a","b","c"],values:[1,3,6]};for(const e in weatherCharts)({}).hasOwnProperty.call(weatherCharts,e)&&updateGraphs(e,b);o.style.display="none",a.style.display="none",r.forEach((e=>{e.classList.remove("blur")}))},getData=()=>{fetch("/dataajax/").then((e=>e.json())).then((e=>updateDashboard(e)))};export const init=e=>{Chart=e;const t=new WeatherChartConfig;for(const e in weatherCharts)({}).hasOwnProperty.call(weatherCharts,e)&&(weatherCharts[e].chartObj=new Chart(document.getElementById(weatherCharts[e].id),t.config));setup(getData),getData()};